<?xml version="1.0" encoding="utf-8"?>
<edmx:Edmx Version="2.0" xmlns:edmx="http://schemas.microsoft.com/ado/2008/10/edmx">
  <!-- EF Runtime content -->
  <edmx:Runtime>
    <!-- SSDL content -->
    <edmx:StorageModels>
    <Schema Namespace="DBMessageChatModel.Store" Alias="Self" Provider="System.Data.SqlClient" ProviderManifestToken="2008" xmlns:store="http://schemas.microsoft.com/ado/2007/12/edm/EntityStoreSchemaGenerator" xmlns="http://schemas.microsoft.com/ado/2009/02/edm/ssdl">
        <EntityContainer Name="DBMessageChatModelStoreContainer">
          <EntitySet Name="Messages" EntityType="DBMessageChatModel.Store.Messages" store:Type="Tables" Schema="dbo" />
          <EntitySet Name="MessagesRecipients" EntityType="DBMessageChatModel.Store.MessagesRecipients" store:Type="Tables" Schema="dbo" />
          <EntitySet Name="MessagesTypes" EntityType="DBMessageChatModel.Store.MessagesTypes" store:Type="Tables" Schema="dbo" />
          <EntitySet Name="UsersConversations" EntityType="DBMessageChatModel.Store.UsersConversations" store:Type="Tables" Schema="dbo" />
          <AssociationSet Name="FK_Messages_MessagesTypes" Association="DBMessageChatModel.Store.FK_Messages_MessagesTypes">
            <End Role="MessagesTypes" EntitySet="MessagesTypes" />
            <End Role="Messages" EntitySet="Messages" />
          </AssociationSet>
          <AssociationSet Name="FK_MessagesRecipients_Messages" Association="DBMessageChatModel.Store.FK_MessagesRecipients_Messages">
            <End Role="Messages" EntitySet="Messages" />
            <End Role="MessagesRecipients" EntitySet="MessagesRecipients" />
          </AssociationSet>
          <AssociationSet Name="FK_MessagesRecipients_UsersConversations" Association="DBMessageChatModel.Store.FK_MessagesRecipients_UsersConversations">
            <End Role="UsersConversations" EntitySet="UsersConversations" />
            <End Role="MessagesRecipients" EntitySet="MessagesRecipients" />
          </AssociationSet>
        </EntityContainer>
        <EntityType Name="Messages">
          <Key>
            <PropertyRef Name="IDMessage" />
          </Key>
          <Property Name="IDMessage" Type="uniqueidentifier" Nullable="false" />
          <Property Name="IDMessageType" Type="int" Nullable="false" />
          <Property Name="Message" Type="nvarchar(max)" Nullable="false" />
        </EntityType>
        <EntityType Name="MessagesRecipients">
          <Key>
            <PropertyRef Name="IDMessageRecipient" />
          </Key>
          <Property Name="IDMessageRecipient" Type="uniqueidentifier" Nullable="false" />
          <Property Name="IDMessage" Type="uniqueidentifier" Nullable="false" />
          <Property Name="IDUserConversation" Type="uniqueidentifier" Nullable="false" />
          <Property Name="IDUserSender" Type="uniqueidentifier" Nullable="false" />
          <Property Name="IDUserRecipient" Type="uniqueidentifier" Nullable="false" />
          <Property Name="SentOn" Type="datetime" Nullable="false" />
          <Property Name="ViewedOn" Type="datetime" />
          <Property Name="DeletedOn" Type="datetime" />
        </EntityType>
        <EntityType Name="MessagesTypes">
          <Key>
            <PropertyRef Name="IDMessageType" />
          </Key>
          <Property Name="IDMessageType" Type="int" Nullable="false" StoreGeneratedPattern="Identity" />
          <Property Name="MessageType" Type="nvarchar" Nullable="false" MaxLength="50" />
          <Property Name="MessageMaxLength" Type="int" Nullable="false" />
          <Property Name="MessageTypeEnabled" Type="bit" Nullable="false" />
        </EntityType>
        <EntityType Name="UsersConversations">
          <Key>
            <PropertyRef Name="IDUserConversation" />
          </Key>
          <Property Name="IDUserConversation" Type="uniqueidentifier" Nullable="false" />
          <Property Name="IDConversation" Type="uniqueidentifier" Nullable="false" />
          <Property Name="IDUser" Type="uniqueidentifier" Nullable="false" />
          <Property Name="CreatedOn" Type="datetime" Nullable="false" />
          <Property Name="ArchivedOn" Type="datetime" />
        </EntityType>
        <Association Name="FK_Messages_MessagesTypes">
          <End Role="MessagesTypes" Type="DBMessageChatModel.Store.MessagesTypes" Multiplicity="1">
            <OnDelete Action="Cascade" />
          </End>
          <End Role="Messages" Type="DBMessageChatModel.Store.Messages" Multiplicity="*" />
          <ReferentialConstraint>
            <Principal Role="MessagesTypes">
              <PropertyRef Name="IDMessageType" />
            </Principal>
            <Dependent Role="Messages">
              <PropertyRef Name="IDMessageType" />
            </Dependent>
          </ReferentialConstraint>
        </Association>
        <Association Name="FK_MessagesRecipients_Messages">
          <End Role="Messages" Type="DBMessageChatModel.Store.Messages" Multiplicity="1">
            <OnDelete Action="Cascade" />
          </End>
          <End Role="MessagesRecipients" Type="DBMessageChatModel.Store.MessagesRecipients" Multiplicity="*" />
          <ReferentialConstraint>
            <Principal Role="Messages">
              <PropertyRef Name="IDMessage" />
            </Principal>
            <Dependent Role="MessagesRecipients">
              <PropertyRef Name="IDMessage" />
            </Dependent>
          </ReferentialConstraint>
        </Association>
        <Association Name="FK_MessagesRecipients_UsersConversations">
          <End Role="UsersConversations" Type="DBMessageChatModel.Store.UsersConversations" Multiplicity="1" />
          <End Role="MessagesRecipients" Type="DBMessageChatModel.Store.MessagesRecipients" Multiplicity="*" />
          <ReferentialConstraint>
            <Principal Role="UsersConversations">
              <PropertyRef Name="IDUserConversation" />
            </Principal>
            <Dependent Role="MessagesRecipients">
              <PropertyRef Name="IDUserConversation" />
            </Dependent>
          </ReferentialConstraint>
        </Association>
        <Function Name="USP_CountMessagesNotRead" Aggregate="false" BuiltIn="false" NiladicFunction="false" IsComposable="false" ParameterTypeSemantics="AllowImplicitConversion" Schema="dbo">
          <Parameter Name="IDUserConversationOwner" Type="uniqueidentifier" Mode="In" />
        </Function>
        <Function Name="USP_GetConversationIdBetweenTwoUsers" Aggregate="false" BuiltIn="false" NiladicFunction="false" IsComposable="false" ParameterTypeSemantics="AllowImplicitConversion" Schema="dbo">
          <Parameter Name="user1" Type="uniqueidentifier" Mode="In" />
          <Parameter Name="user2" Type="uniqueidentifier" Mode="In" />
        </Function>
        <Function Name="USP_GetMessageInfoByID" Aggregate="false" BuiltIn="false" NiladicFunction="false" IsComposable="false" ParameterTypeSemantics="AllowImplicitConversion" Schema="dbo">
          <Parameter Name="IDMessage" Type="uniqueidentifier" Mode="In" />
        </Function>
        <Function Name="USP_GetMessagesOfAConversation" Aggregate="false" BuiltIn="false" NiladicFunction="false" IsComposable="false" ParameterTypeSemantics="AllowImplicitConversion" Schema="dbo">
          <Parameter Name="IDUserConversationOwner" Type="uniqueidentifier" Mode="In" />
          <Parameter Name="IDConversation" Type="uniqueidentifier" Mode="In" />
        </Function>
        <Function Name="USP_GetMessagesOfAConversationPaged" Aggregate="false" BuiltIn="false" NiladicFunction="false" IsComposable="false" ParameterTypeSemantics="AllowImplicitConversion" Schema="dbo">
          <Parameter Name="IDUserConversationOwner" Type="uniqueidentifier" Mode="In" />
          <Parameter Name="IDConversation" Type="uniqueidentifier" Mode="In" />
          <Parameter Name="Offset" Type="int" Mode="In" />
          <Parameter Name="PageSize" Type="int" Mode="In" />
        </Function>
        <Function Name="USP_GetMessagesToRead" Aggregate="false" BuiltIn="false" NiladicFunction="false" IsComposable="false" ParameterTypeSemantics="AllowImplicitConversion" Schema="dbo">
          <Parameter Name="IDUserConversationOwner" Type="uniqueidentifier" Mode="In" />
        </Function>
        <Function Name="USP_GetMessagesToReadByUser" Aggregate="false" BuiltIn="false" NiladicFunction="false" IsComposable="false" ParameterTypeSemantics="AllowImplicitConversion" Schema="dbo">
          <Parameter Name="IDUserConversationOwner" Type="uniqueidentifier" Mode="In" />
          <Parameter Name="IDUserSender" Type="uniqueidentifier" Mode="In" />
        </Function>
        <Function Name="USP_GetMyConversations" Aggregate="false" BuiltIn="false" NiladicFunction="false" IsComposable="false" ParameterTypeSemantics="AllowImplicitConversion" Schema="dbo">
          <Parameter Name="me" Type="uniqueidentifier" Mode="In" />
        </Function>
        <Function Name="USP_GetTypeOfMessageInfoByID" Aggregate="false" BuiltIn="false" NiladicFunction="false" IsComposable="false" ParameterTypeSemantics="AllowImplicitConversion" Schema="dbo">
          <Parameter Name="IDMessageType" Type="int" Mode="In" />
        </Function>
        <Function Name="USP_GetUsersOfAConversation" Aggregate="false" BuiltIn="false" NiladicFunction="false" IsComposable="false" ParameterTypeSemantics="AllowImplicitConversion" Schema="dbo">
          <Parameter Name="IDConversation" Type="uniqueidentifier" Mode="In" />
        </Function>
        <Function Name="USP_InsertConversation" Aggregate="false" BuiltIn="false" NiladicFunction="false" IsComposable="false" ParameterTypeSemantics="AllowImplicitConversion" Schema="dbo">
          <Parameter Name="IDUser" Type="uniqueidentifier" Mode="In" />
          <Parameter Name="IDConversation" Type="uniqueidentifier" Mode="In" />
          <Parameter Name="CreatedOn" Type="datetime" Mode="In" />
        </Function>
        <Function Name="USP_InsertMessage" Aggregate="false" BuiltIn="false" NiladicFunction="false" IsComposable="false" ParameterTypeSemantics="AllowImplicitConversion" Schema="dbo">
          <Parameter Name="IDMessageType" Type="int" Mode="In" />
          <Parameter Name="Message" Type="nvarchar(max)" Mode="In" />
        </Function>
        <Function Name="USP_InsertMessageRecipient" Aggregate="false" BuiltIn="false" NiladicFunction="false" IsComposable="false" ParameterTypeSemantics="AllowImplicitConversion" Schema="dbo">
          <Parameter Name="IDMessage" Type="uniqueidentifier" Mode="In" />
          <Parameter Name="IDUserConversation" Type="uniqueidentifier" Mode="In" />
          <Parameter Name="IDUserSender" Type="uniqueidentifier" Mode="In" />
          <Parameter Name="IDUserRecipient" Type="uniqueidentifier" Mode="In" />
          <Parameter Name="SentOn" Type="datetime" Mode="In" />
          <Parameter Name="ViewedOn" Type="datetime" Mode="In" />
          <Parameter Name="DeletedOn" Type="datetime" Mode="In" />
        </Function>
        <Function Name="USP_IsUserPartOfAConversation" Aggregate="false" BuiltIn="false" NiladicFunction="false" IsComposable="false" ParameterTypeSemantics="AllowImplicitConversion" Schema="dbo">
          <Parameter Name="IDUser" Type="uniqueidentifier" Mode="In" />
          <Parameter Name="IDConversation" Type="uniqueidentifier" Mode="In" />
        </Function>
        <Function Name="USP_MessageSetAsDeleted" Aggregate="false" BuiltIn="false" NiladicFunction="false" IsComposable="false" ParameterTypeSemantics="AllowImplicitConversion" Schema="dbo">
          <Parameter Name="IDMessageRecipient" Type="uniqueidentifier" Mode="In" />
        </Function>
        <Function Name="USP_MessageSetAsViewed" Aggregate="false" BuiltIn="false" NiladicFunction="false" IsComposable="false" ParameterTypeSemantics="AllowImplicitConversion" Schema="dbo">
          <Parameter Name="IDUserConversationOwner" Type="uniqueidentifier" Mode="In" />
        </Function>
        <Function Name="USP_MessagesNumberOfAConversation" Aggregate="false" BuiltIn="false" NiladicFunction="false" IsComposable="false" ParameterTypeSemantics="AllowImplicitConversion" Schema="dbo">
          <Parameter Name="IDUserConversationOwner" Type="uniqueidentifier" Mode="In" />
          <Parameter Name="IDConversation" Type="uniqueidentifier" Mode="In" />
        </Function>
        <Function Name="USP_MessagesOfAConversationSetAsViewed" Aggregate="false" BuiltIn="false" NiladicFunction="false" IsComposable="false" ParameterTypeSemantics="AllowImplicitConversion" Schema="dbo">
          <Parameter Name="IDUserConversationOwner" Type="uniqueidentifier" Mode="In" />
          <Parameter Name="IDConversation" Type="uniqueidentifier" Mode="In" />
        </Function>
        <Function Name="USP_UserConversationSetAsActive" Aggregate="false" BuiltIn="false" NiladicFunction="false" IsComposable="false" ParameterTypeSemantics="AllowImplicitConversion" Schema="dbo">
          <Parameter Name="IDConversation" Type="uniqueidentifier" Mode="In" />
        </Function>
        <Function Name="USP_UserConversationSetAsArchived" Aggregate="false" BuiltIn="false" NiladicFunction="false" IsComposable="false" ParameterTypeSemantics="AllowImplicitConversion" Schema="dbo">
          <Parameter Name="IDUserConversation" Type="uniqueidentifier" Mode="In" />
        </Function>
      </Schema></edmx:StorageModels>
    <!-- CSDL content -->
    <edmx:ConceptualModels>
      <Schema Namespace="DBMessageChatModel" Alias="Self" xmlns:annotation="http://schemas.microsoft.com/ado/2009/02/edm/annotation" xmlns="http://schemas.microsoft.com/ado/2008/09/edm">
        <EntityContainer Name="DBMessageChatEntity" annotation:LazyLoadingEnabled="true">
          <EntitySet Name="Messages" EntityType="DBMessageChatModel.Messages" />
          <EntitySet Name="MessagesRecipients" EntityType="DBMessageChatModel.MessagesRecipients" />
          <EntitySet Name="MessagesTypes" EntityType="DBMessageChatModel.MessagesTypes" />
          <AssociationSet Name="FK_Messages_MessagesTypes" Association="DBMessageChatModel.FK_Messages_MessagesTypes">
            <End Role="MessagesTypes" EntitySet="MessagesTypes" />
            <End Role="Messages" EntitySet="Messages" />
          </AssociationSet>
          <AssociationSet Name="FK_MessagesRecipients_Messages" Association="DBMessageChatModel.FK_MessagesRecipients_Messages">
            <End Role="Messages" EntitySet="Messages" />
            <End Role="MessagesRecipients" EntitySet="MessagesRecipients" />
          </AssociationSet>
          <FunctionImport Name="USP_GetTypeOfMessageInfoByID" EntitySet="MessagesTypes" ReturnType="Collection(DBMessageChatModel.MessagesTypes)">
          <Parameter Name="IDMessageType" Mode="In" Type="Int32" />
          </FunctionImport>
          <FunctionImport Name="USP_InsertMessageRecipient" ReturnType="Collection(DBMessageChatModel.USPResult)">
            <Parameter Name="IDMessage" Mode="In" Type="Guid" />
            <Parameter Name="IDUserConversation" Mode="In" Type="Guid" />
            <Parameter Name="IDUserSender" Mode="In" Type="Guid" />
            <Parameter Name="IDUserRecipient" Mode="In" Type="Guid" />
            <Parameter Name="SentOn" Mode="In" Type="DateTime" />
            <Parameter Name="ViewedOn" Mode="In" Type="DateTime" />
            <Parameter Name="DeletedOn" Mode="In" Type="DateTime" />
          </FunctionImport>
          <FunctionImport Name="USP_GetMessageInfoByID" EntitySet="Messages" ReturnType="Collection(DBMessageChatModel.Messages)">
          <Parameter Name="IDMessage" Mode="In" Type="Guid" />
          </FunctionImport>
          <FunctionImport Name="USP_InsertMessage" ReturnType="Collection(DBMessageChatModel.USPResult)">
            <Parameter Name="IDMessageType" Mode="In" Type="Int32" />
            <Parameter Name="Message" Mode="In" Type="String" />
          </FunctionImport>
          <FunctionImport Name="USP_MessageSetAsDeleted" ReturnType="Collection(DBMessageChatModel.USPResult)">
          <Parameter Name="IDMessageRecipient" Mode="In" Type="Guid" />
          </FunctionImport>
          <EntitySet Name="UsersConversations" EntityType="DBMessageChatModel.UsersConversations" />
          <AssociationSet Name="FK_MessagesRecipients_UsersConversations" Association="DBMessageChatModel.FK_MessagesRecipients_UsersConversations">
            <End Role="UsersConversations" EntitySet="UsersConversations" />
            <End Role="MessagesRecipients" EntitySet="MessagesRecipients" />
          </AssociationSet>
          <FunctionImport Name="USP_InsertConversation" ReturnType="Collection(DBMessageChatModel.USPResult)">
            <Parameter Name="IDUser" Mode="In" Type="Guid" />
            <Parameter Name="IDConversation" Mode="In" Type="Guid" />
            <Parameter Name="CreatedOn" Mode="In" Type="DateTime" />
          </FunctionImport>
          <FunctionImport Name="USP_UserConversationSetAsArchived" ReturnType="Collection(DBMessageChatModel.USPResult)">
          <Parameter Name="IDUserConversation" Mode="In" Type="Guid" />
          </FunctionImport>
          <FunctionImport Name="USP_GetUsersOfAConversation" EntitySet="UsersConversations" ReturnType="Collection(DBMessageChatModel.UsersConversations)">
          <Parameter Name="IDConversation" Mode="In" Type="Guid" />
          </FunctionImport>
          <FunctionImport Name="USP_IsUserPartOfAConversation" EntitySet="UsersConversations" ReturnType="Collection(DBMessageChatModel.UsersConversations)">
            <Parameter Name="IDUser" Mode="In" Type="Guid" />
            <Parameter Name="IDConversation" Mode="In" Type="Guid" />
          </FunctionImport>
          <FunctionImport Name="USP_MessageSetAsViewed" ReturnType="Collection(DBMessageChatModel.USPResult)">
          <Parameter Name="IDUserConversationOwner" Mode="In" Type="Guid" />
          </FunctionImport>
          <FunctionImport Name="USP_GetConversationIdBetweenTwoUsers" ReturnType="Collection(DBMessageChatModel.Conversation)">
            <Parameter Name="user1" Mode="In" Type="Guid" />
            <Parameter Name="user2" Mode="In" Type="Guid" />
          </FunctionImport>
          <FunctionImport Name="USP_GetMessagesOfAConversation" ReturnType="Collection(DBMessageChatModel.MessagesOfConversation)">
            <Parameter Name="IDUserConversationOwner" Mode="In" Type="Guid" />
            <Parameter Name="IDConversation" Mode="In" Type="Guid" />
          </FunctionImport>
          <FunctionImport Name="USP_UserConversationSetAsActive" ReturnType="Collection(DBMessageChatModel.USPResult)">
          <Parameter Name="IDConversation" Mode="In" Type="Guid" />
          </FunctionImport>
          <FunctionImport Name="USP_GetMyConversations" ReturnType="Collection(DBMessageChatModel.ListOfConversations)">
          <Parameter Name="me" Mode="In" Type="Guid" />
          </FunctionImport>
          <FunctionImport Name="USP_GetMessagesToRead" ReturnType="Collection(DBMessageChatModel.MessagesToRead)">
          <Parameter Name="IDUserConversationOwner" Mode="In" Type="Guid" />
          </FunctionImport>
          <FunctionImport Name="USP_MessagesOfAConversationSetAsViewed" ReturnType="Collection(DBMessageChatModel.USPResult)">
            <Parameter Name="IDUserConversationOwner" Mode="In" Type="Guid" />
            <Parameter Name="IDConversation" Mode="In" Type="Guid" />
          </FunctionImport>
          <FunctionImport Name="USP_GetMessagesOfAConversationPaged" ReturnType="Collection(DBMessageChatModel.MessagesOfConversation)">
            <Parameter Name="IDUserConversationOwner" Mode="In" Type="Guid" />
            <Parameter Name="IDConversation" Mode="In" Type="Guid" />
            <Parameter Name="Offset" Mode="In" Type="Int32" />
            <Parameter Name="PageSize" Mode="In" Type="Int32" />
          </FunctionImport>
          <FunctionImport Name="USP_MessagesNumberOfAConversation" ReturnType="Collection(DBMessageChatModel.NumberOfMessages)">
            <Parameter Name="IDUserConversationOwner" Mode="In" Type="Guid" />
            <Parameter Name="IDConversation" Mode="In" Type="Guid" />
          </FunctionImport>
          <FunctionImport Name="USP_GetMessagesToReadByUser" ReturnType="Collection(DBMessageChatModel.MessagesToRead)">
            <Parameter Name="IDUserConversationOwner" Mode="In" Type="Guid" />
            <Parameter Name="IDUserSender" Mode="In" Type="Guid" />
          </FunctionImport>
          <FunctionImport Name="USP_CountMessagesNotRead" ReturnType="Collection(DBMessageChatModel.NumberOfMessages)">
          <Parameter Name="IDUserConversationOwner" Mode="In" Type="Guid" />
          </FunctionImport>
        </EntityContainer>
        <EntityType Name="Messages">
          <Key>
            <PropertyRef Name="IDMessage" />
          </Key>
          <Property Name="IDMessage" Type="Guid" Nullable="false" />
          <Property Name="IDMessageType" Type="Int32" Nullable="false" />
          <Property Name="Message" Type="String" Nullable="false" MaxLength="Max" Unicode="true" FixedLength="false" />
          <NavigationProperty Name="MessagesTypes" Relationship="DBMessageChatModel.FK_Messages_MessagesTypes" FromRole="Messages" ToRole="MessagesTypes" />
          <NavigationProperty Name="MessagesRecipients" Relationship="DBMessageChatModel.FK_MessagesRecipients_Messages" FromRole="Messages" ToRole="MessagesRecipients" />
        </EntityType>
        <EntityType Name="MessagesRecipients">
          <Key>
            <PropertyRef Name="IDMessageRecipient" />
          </Key>
          <Property Name="IDMessageRecipient" Type="Guid" Nullable="false" />
          <Property Name="IDMessage" Type="Guid" Nullable="false" />
          <Property Name="IDUserRecipient" Type="Guid" Nullable="false" />
          <Property Name="ViewedOn" Type="DateTime" />
          <Property Name="DeletedOn" Type="DateTime" />
          <NavigationProperty Name="Messages" Relationship="DBMessageChatModel.FK_MessagesRecipients_Messages" FromRole="MessagesRecipients" ToRole="Messages" />
          <Property Type="Guid" Name="IDUserConversation" Nullable="false" />
          <Property Type="Guid" Name="IDUserSender" Nullable="false" />
          <Property Type="DateTime" Name="SentOn" Nullable="false" />
          <NavigationProperty Name="UsersConversations" Relationship="DBMessageChatModel.FK_MessagesRecipients_UsersConversations" FromRole="MessagesRecipients" ToRole="UsersConversations" />
        </EntityType>
        <EntityType Name="MessagesTypes">
          <Key>
            <PropertyRef Name="IDMessageType" />
          </Key>
          <Property Name="IDMessageType" Type="Int32" Nullable="false" annotation:StoreGeneratedPattern="Identity" />
          <Property Name="MessageType" Type="String" Nullable="false" MaxLength="50" Unicode="true" FixedLength="false" />
          <Property Name="MessageMaxLength" Type="Int32" Nullable="false" />
          <Property Name="MessageTypeEnabled" Type="Boolean" Nullable="false" />
          <NavigationProperty Name="Messages" Relationship="DBMessageChatModel.FK_Messages_MessagesTypes" FromRole="MessagesTypes" ToRole="Messages" />
        </EntityType>
        <Association Name="FK_Messages_MessagesTypes">
          <End Role="MessagesTypes" Type="DBMessageChatModel.MessagesTypes" Multiplicity="1" />
          <End Role="Messages" Type="DBMessageChatModel.Messages" Multiplicity="*" />
          <ReferentialConstraint>
            <Principal Role="MessagesTypes">
              <PropertyRef Name="IDMessageType" />
            </Principal>
            <Dependent Role="Messages">
              <PropertyRef Name="IDMessageType" />
            </Dependent>
          </ReferentialConstraint>
        </Association>
        <Association Name="FK_MessagesRecipients_Messages">
          <End Role="Messages" Type="DBMessageChatModel.Messages" Multiplicity="1">
            <OnDelete Action="Cascade" />
          </End>
          <End Role="MessagesRecipients" Type="DBMessageChatModel.MessagesRecipients" Multiplicity="*" />
          <ReferentialConstraint>
            <Principal Role="Messages">
              <PropertyRef Name="IDMessage" />
            </Principal>
            <Dependent Role="MessagesRecipients">
              <PropertyRef Name="IDMessage" />
            </Dependent>
          </ReferentialConstraint>
        </Association>
        <ComplexType Name="USPResult" >
          <Property Type="Boolean" Name="isError" Nullable="false" />
          <Property Type="String" Name="ResultExecutionCode" Nullable="false" />
          <Property Type="String" Name="USPReturnValue" Nullable="false" />
        </ComplexType>
        <ComplexType Name="ListOfUserSender" >
          <Property Type="Guid" Name="IDUserSender" Nullable="false" />
        </ComplexType>
        <EntityType Name="UsersConversations">
          <Key>
            <PropertyRef Name="IDUserConversation" />
          </Key>
          <Property Type="Guid" Name="IDUserConversation" Nullable="false" />
          <Property Type="Guid" Name="IDConversation" Nullable="false" />
          <Property Type="Guid" Name="IDUser" Nullable="false" />
          <Property Type="DateTime" Name="CreatedOn" Nullable="false" />
          <Property Type="DateTime" Name="ArchivedOn" />
          <NavigationProperty Name="MessagesRecipients" Relationship="DBMessageChatModel.FK_MessagesRecipients_UsersConversations" FromRole="UsersConversations" ToRole="MessagesRecipients" />
        </EntityType>
        <Association Name="FK_MessagesRecipients_UsersConversations">
          <End Type="DBMessageChatModel.UsersConversations" Role="UsersConversations" Multiplicity="1" />
          <End Type="DBMessageChatModel.MessagesRecipients" Role="MessagesRecipients" Multiplicity="*" />
          <ReferentialConstraint>
            <Principal Role="UsersConversations">
              <PropertyRef Name="IDUserConversation" />
            </Principal>
            <Dependent Role="MessagesRecipients">
              <PropertyRef Name="IDUserConversation" />
            </Dependent>
          </ReferentialConstraint>
        </Association>
        <ComplexType Name="Conversation" >
          <Property Type="Guid" Name="IDConversation" Nullable="false" />
        </ComplexType>
        <ComplexType Name="MessagesOfConversation" >
          <Property Type="Guid" Name="IDMessage" Nullable="false" />
          <Property Type="String" Name="Message" Nullable="false" />
          <Property Type="Guid" Name="IDMessageRecipient" Nullable="false" />
          <Property Type="Guid" Name="IDUserConversation" Nullable="false" />
          <Property Type="Guid" Name="IDUserSender" Nullable="false" />
          <Property Type="DateTime" Name="SentOn" Nullable="false" />
          <Property Type="Guid" Name="IDConversation" Nullable="false" />
          <Property Type="DateTime" Name="CreatedOn" Nullable="false" />
        </ComplexType>
        <ComplexType Name="ListOfConversations" >
          <Property Type="Guid" Name="IDUser" Nullable="false" />
          <Property Type="Guid" Name="IDUserConversation" Nullable="false" />
          <Property Type="Guid" Name="IDConversation" Nullable="false" />
          <Property Type="Guid" Name="Friend" Nullable="false" />
          <Property Type="DateTime" Name="LastDateMessage" Nullable="true" />
        </ComplexType>
        <ComplexType Name="MessagesToRead" >
          <Property Type="Guid" Name="IDMessage" Nullable="false" />
          <Property Type="String" Name="Message" Nullable="false" />
          <Property Type="Guid" Name="IDUserSender" Nullable="false" />
          <Property Type="DateTime" Name="SentOn" Nullable="false" />
        </ComplexType>
        <ComplexType Name="NumberOfMessages" >
          <Property Type="Int32" Name="MessagesNumber" Nullable="false" />
        </ComplexType>
      </Schema>
    </edmx:ConceptualModels>
    <!-- C-S mapping content -->
    <edmx:Mappings>
      <Mapping Space="C-S" xmlns="http://schemas.microsoft.com/ado/2008/09/mapping/cs">
        <EntityContainerMapping StorageEntityContainer="DBMessageChatModelStoreContainer" CdmEntityContainer="DBMessageChatEntity">
          <EntitySetMapping Name="Messages">
            <EntityTypeMapping TypeName="DBMessageChatModel.Messages">
              <MappingFragment StoreEntitySet="Messages">
                <ScalarProperty Name="IDMessage" ColumnName="IDMessage" />
                <ScalarProperty Name="IDMessageType" ColumnName="IDMessageType" />
                <ScalarProperty Name="Message" ColumnName="Message" />
                </MappingFragment>
            </EntityTypeMapping>
          </EntitySetMapping>
          <EntitySetMapping Name="MessagesRecipients">
            <EntityTypeMapping TypeName="DBMessageChatModel.MessagesRecipients">
              <MappingFragment StoreEntitySet="MessagesRecipients">
                <ScalarProperty Name="SentOn" ColumnName="SentOn" />
                <ScalarProperty Name="IDUserSender" ColumnName="IDUserSender" />
                <ScalarProperty Name="IDUserConversation" ColumnName="IDUserConversation" />
                <ScalarProperty Name="IDMessageRecipient" ColumnName="IDMessageRecipient" />
                <ScalarProperty Name="IDMessage" ColumnName="IDMessage" />
                <ScalarProperty Name="IDUserRecipient" ColumnName="IDUserRecipient" />
                <ScalarProperty Name="ViewedOn" ColumnName="ViewedOn" />
                <ScalarProperty Name="DeletedOn" ColumnName="DeletedOn" />
              </MappingFragment>
            </EntityTypeMapping>
          </EntitySetMapping>
          <EntitySetMapping Name="MessagesTypes">
            <EntityTypeMapping TypeName="DBMessageChatModel.MessagesTypes">
              <MappingFragment StoreEntitySet="MessagesTypes">
                <ScalarProperty Name="IDMessageType" ColumnName="IDMessageType" />
                <ScalarProperty Name="MessageType" ColumnName="MessageType" />
                <ScalarProperty Name="MessageMaxLength" ColumnName="MessageMaxLength" />
                <ScalarProperty Name="MessageTypeEnabled" ColumnName="MessageTypeEnabled" />
              </MappingFragment>
            </EntityTypeMapping>
          </EntitySetMapping>
          <FunctionImportMapping FunctionImportName="USP_GetTypeOfMessageInfoByID" FunctionName="DBMessageChatModel.Store.USP_GetTypeOfMessageInfoByID" />
          <FunctionImportMapping FunctionImportName="USP_InsertMessageRecipient" FunctionName="DBMessageChatModel.Store.USP_InsertMessageRecipient" >
            <ResultMapping>
              <ComplexTypeMapping TypeName="DBMessageChatModel.USPResult">
                <ScalarProperty Name="ResultExecutionCode" ColumnName="ResultExecutionCode" />
                <ScalarProperty Name="USPReturnValue" ColumnName="USPReturnValue" />
                <ScalarProperty Name="isError" ColumnName="isError" />
              </ComplexTypeMapping>
            </ResultMapping>
          </FunctionImportMapping>
          <FunctionImportMapping FunctionImportName="USP_GetMessageInfoByID" FunctionName="DBMessageChatModel.Store.USP_GetMessageInfoByID" />
          <FunctionImportMapping FunctionImportName="USP_InsertMessage" FunctionName="DBMessageChatModel.Store.USP_InsertMessage">
            <ResultMapping>
              <ComplexTypeMapping TypeName="DBMessageChatModel.USPResult">
                <ScalarProperty Name="ResultExecutionCode" ColumnName="ResultExecutionCode" />
                <ScalarProperty Name="USPReturnValue" ColumnName="USPReturnValue" />
                <ScalarProperty Name="isError" ColumnName="isError" />
              </ComplexTypeMapping>
            </ResultMapping>
          </FunctionImportMapping>
          <FunctionImportMapping FunctionImportName="USP_MessageSetAsDeleted" FunctionName="DBMessageChatModel.Store.USP_MessageSetAsDeleted">
            <ResultMapping>
              <ComplexTypeMapping TypeName="DBMessageChatModel.USPResult">
                <ScalarProperty Name="ResultExecutionCode" ColumnName="ResultExecutionCode" />
                <ScalarProperty Name="USPReturnValue" ColumnName="USPReturnValue" />
                <ScalarProperty Name="isError" ColumnName="isError" />
              </ComplexTypeMapping>
            </ResultMapping>
          </FunctionImportMapping>
          <EntitySetMapping Name="UsersConversations">
            <EntityTypeMapping TypeName="DBMessageChatModel.UsersConversations">
              <MappingFragment StoreEntitySet="UsersConversations">
                <ScalarProperty Name="ArchivedOn" ColumnName="ArchivedOn" />
                <ScalarProperty Name="CreatedOn" ColumnName="CreatedOn" />
                <ScalarProperty Name="IDUser" ColumnName="IDUser" />
                <ScalarProperty Name="IDConversation" ColumnName="IDConversation" />
                <ScalarProperty Name="IDUserConversation" ColumnName="IDUserConversation" />
              </MappingFragment>
            </EntityTypeMapping>
          </EntitySetMapping>
          <FunctionImportMapping FunctionImportName="USP_InsertConversation" FunctionName="DBMessageChatModel.Store.USP_InsertConversation">
            <ResultMapping>
              <ComplexTypeMapping TypeName="DBMessageChatModel.USPResult">
                <ScalarProperty Name="isError" ColumnName="isError" />
                <ScalarProperty Name="ResultExecutionCode" ColumnName="ResultExecutionCode" />
                <ScalarProperty Name="USPReturnValue" ColumnName="USPReturnValue" />
              </ComplexTypeMapping>
            </ResultMapping>
          </FunctionImportMapping>
          <FunctionImportMapping FunctionImportName="USP_UserConversationSetAsArchived" FunctionName="DBMessageChatModel.Store.USP_UserConversationSetAsArchived">
            <ResultMapping>
              <ComplexTypeMapping TypeName="DBMessageChatModel.USPResult">
                <ScalarProperty Name="isError" ColumnName="isError" />
                <ScalarProperty Name="ResultExecutionCode" ColumnName="ResultExecutionCode" />
                <ScalarProperty Name="USPReturnValue" ColumnName="USPReturnValue" />
              </ComplexTypeMapping>
            </ResultMapping>
          </FunctionImportMapping>
          <FunctionImportMapping FunctionImportName="USP_GetUsersOfAConversation" FunctionName="DBMessageChatModel.Store.USP_GetUsersOfAConversation" />
          <FunctionImportMapping FunctionImportName="USP_IsUserPartOfAConversation" FunctionName="DBMessageChatModel.Store.USP_IsUserPartOfAConversation" />
          <FunctionImportMapping FunctionImportName="USP_MessageSetAsViewed" FunctionName="DBMessageChatModel.Store.USP_MessageSetAsViewed">
            <ResultMapping>
              <ComplexTypeMapping TypeName="DBMessageChatModel.USPResult">
                <ScalarProperty Name="isError" ColumnName="isError" />
                <ScalarProperty Name="ResultExecutionCode" ColumnName="ResultExecutionCode" />
                <ScalarProperty Name="USPReturnValue" ColumnName="USPReturnValue" />
              </ComplexTypeMapping>
            </ResultMapping>
          </FunctionImportMapping>
          <FunctionImportMapping FunctionImportName="USP_GetConversationIdBetweenTwoUsers" FunctionName="DBMessageChatModel.Store.USP_GetConversationIdBetweenTwoUsers" >
            <ResultMapping>
              <ComplexTypeMapping TypeName="DBMessageChatModel.Conversation">
                <ScalarProperty Name="IDConversation" ColumnName="IDConversation" />
              </ComplexTypeMapping>
            </ResultMapping>
          </FunctionImportMapping>
          <FunctionImportMapping FunctionImportName="USP_GetMessagesOfAConversation" FunctionName="DBMessageChatModel.Store.USP_GetMessagesOfAConversation">
            <ResultMapping>
              <ComplexTypeMapping TypeName="DBMessageChatModel.MessagesOfConversation">
                <ScalarProperty Name="IDMessage" ColumnName="IDMessage" />
                <ScalarProperty Name="Message" ColumnName="Message" />
                <ScalarProperty Name="IDMessageRecipient" ColumnName="IDMessageRecipient" />
                <ScalarProperty Name="IDUserConversation" ColumnName="IDUserConversation" />
                <ScalarProperty Name="IDUserSender" ColumnName="IDUserSender" />
                <ScalarProperty Name="SentOn" ColumnName="SentOn" />
                <ScalarProperty Name="IDConversation" ColumnName="IDConversation" />
                <ScalarProperty Name="CreatedOn" ColumnName="CreatedOn" />
              </ComplexTypeMapping>
            </ResultMapping>
          </FunctionImportMapping>
          <FunctionImportMapping FunctionImportName="USP_UserConversationSetAsActive" FunctionName="DBMessageChatModel.Store.USP_UserConversationSetAsActive">
            <ResultMapping>
              <ComplexTypeMapping TypeName="DBMessageChatModel.USPResult">
                <ScalarProperty Name="isError" ColumnName="isError" />
                <ScalarProperty Name="ResultExecutionCode" ColumnName="ResultExecutionCode" />
                <ScalarProperty Name="USPReturnValue" ColumnName="USPReturnValue" />
              </ComplexTypeMapping>
            </ResultMapping>
          </FunctionImportMapping>
          <FunctionImportMapping FunctionImportName="USP_GetMyConversations" FunctionName="DBMessageChatModel.Store.USP_GetMyConversations">
            <ResultMapping>
              <ComplexTypeMapping TypeName="DBMessageChatModel.ListOfConversations">
                <ScalarProperty Name="IDUser" ColumnName="IDUser" />
                <ScalarProperty Name="IDUserConversation" ColumnName="IDUserConversation" />
                <ScalarProperty Name="IDConversation" ColumnName="IDConversation" />
                <ScalarProperty Name="Friend" ColumnName="Friend" />
                <ScalarProperty Name="LastDateMessage" ColumnName="LastDateMessage" />
              </ComplexTypeMapping>
            </ResultMapping>
          </FunctionImportMapping>
          <FunctionImportMapping FunctionImportName="USP_GetMessagesToRead" FunctionName="DBMessageChatModel.Store.USP_GetMessagesToRead">
            <ResultMapping>
              <ComplexTypeMapping TypeName="DBMessageChatModel.MessagesToRead">
                <ScalarProperty Name="IDMessage" ColumnName="IDMessage" />
                <ScalarProperty Name="Message" ColumnName="Message" />
                <ScalarProperty Name="IDUserSender" ColumnName="IDUserSender" />
              </ComplexTypeMapping>
            </ResultMapping>
          </FunctionImportMapping>
          <FunctionImportMapping FunctionImportName="USP_MessagesOfAConversationSetAsViewed" FunctionName="DBMessageChatModel.Store.USP_MessagesOfAConversationSetAsViewed">
            <ResultMapping>
              <ComplexTypeMapping TypeName="DBMessageChatModel.USPResult">
                <ScalarProperty Name="isError" ColumnName="isError" />
                <ScalarProperty Name="ResultExecutionCode" ColumnName="ResultExecutionCode" />
                <ScalarProperty Name="USPReturnValue" ColumnName="USPReturnValue" />
              </ComplexTypeMapping>
            </ResultMapping>
          </FunctionImportMapping>
          <FunctionImportMapping FunctionImportName="USP_GetMessagesOfAConversationPaged" FunctionName="DBMessageChatModel.Store.USP_GetMessagesOfAConversationPaged">
          <ResultMapping>
              <ComplexTypeMapping TypeName="DBMessageChatModel.MessagesOfConversation">
                <ScalarProperty Name="IDMessage" ColumnName="IDMessage" />
                <ScalarProperty Name="Message" ColumnName="Message" />
                <ScalarProperty Name="IDMessageRecipient" ColumnName="IDMessageRecipient" />
                <ScalarProperty Name="IDUserConversation" ColumnName="IDUserConversation" />
                <ScalarProperty Name="IDUserSender" ColumnName="IDUserSender" />
                <ScalarProperty Name="SentOn" ColumnName="SentOn" />
                <ScalarProperty Name="IDConversation" ColumnName="IDConversation" />
                <ScalarProperty Name="CreatedOn" ColumnName="CreatedOn" />
              </ComplexTypeMapping>
            </ResultMapping>
          </FunctionImportMapping>
          <FunctionImportMapping FunctionImportName="USP_MessagesNumberOfAConversation" FunctionName="DBMessageChatModel.Store.USP_MessagesNumberOfAConversation">
            <ResultMapping>
              <ComplexTypeMapping TypeName="DBMessageChatModel.NumberOfMessages">
                <ScalarProperty Name="MessagesNumber" ColumnName="MessagesNumber" />
              </ComplexTypeMapping>
            </ResultMapping>
          </FunctionImportMapping>
          <FunctionImportMapping FunctionImportName="USP_GetMessagesToReadByUser" FunctionName="DBMessageChatModel.Store.USP_GetMessagesToReadByUser">
            <ResultMapping>
              <ComplexTypeMapping TypeName="DBMessageChatModel.MessagesToRead">
                <ScalarProperty Name="IDMessage" ColumnName="IDMessage" />
                <ScalarProperty Name="Message" ColumnName="Message" />
                <ScalarProperty Name="IDUserSender" ColumnName="IDUserSender" />
              </ComplexTypeMapping>
            </ResultMapping>
          </FunctionImportMapping>
          <FunctionImportMapping FunctionImportName="USP_CountMessagesNotRead" FunctionName="DBMessageChatModel.Store.USP_CountMessagesNotRead">
            <ResultMapping>
              <ComplexTypeMapping TypeName="DBMessageChatModel.NumberOfMessages">
                <ScalarProperty Name="MessagesNumber" ColumnName="MessagesNumber" />
              </ComplexTypeMapping>
            </ResultMapping>
          </FunctionImportMapping>
        </EntityContainerMapping>
      </Mapping>
    </edmx:Mappings>
  </edmx:Runtime>
  <!-- EF Designer content (DO NOT EDIT MANUALLY BELOW HERE) -->
  <Designer xmlns="http://schemas.microsoft.com/ado/2008/10/edmx">
    <Connection>
      <DesignerInfoPropertySet>
        <DesignerProperty Name="MetadataArtifactProcessing" Value="EmbedInOutputAssembly" />
      </DesignerInfoPropertySet>
    </Connection>
    <Options>
      <DesignerInfoPropertySet>
        <DesignerProperty Name="ValidateOnBuild" Value="true" />
        <DesignerProperty Name="EnablePluralization" Value="False" />
        <DesignerProperty Name="IncludeForeignKeysInModel" Value="True" />
      </DesignerInfoPropertySet>
    </Options>
    <!-- Diagram content (shape and connector positions) -->
    <Diagrams>
      <Diagram Name="MessageType">
        <EntityTypeShape EntityType="DBMessageChatModel.Messages" Width="1.5" PointX="3" PointY="1" Height="1.9802864583333331" IsExpanded="true" />
        <EntityTypeShape EntityType="DBMessageChatModel.MessagesRecipients" Width="1.5" PointX="5.25" PointY="1" Height="2.172587890625" IsExpanded="true" />
        <EntityTypeShape EntityType="DBMessageChatModel.MessagesTypes" Width="1.5" PointX="0.75" PointY="1.25" Height="1.9802864583333335" IsExpanded="true" />
        <AssociationConnector Association="DBMessageChatModel.FK_Messages_MessagesTypes" ManuallyRouted="false">
          <ConnectorPoint PointX="2.25" PointY="2.1151432291666667" />
          <ConnectorPoint PointX="3" PointY="2.1151432291666667" />
        </AssociationConnector>
        <AssociationConnector Association="DBMessageChatModel.FK_MessagesRecipients_Messages" ManuallyRouted="false">
          <ConnectorPoint PointX="4.5" PointY="1.9901432291666665" />
          <ConnectorPoint PointX="5.25" PointY="1.9901432291666665" />
        </AssociationConnector>
        <EntityTypeShape EntityType="DBMessageChatModel.UsersConversations" Width="1.5" PointX="7.375" PointY="1.25" Height="2.1725878906249996" />
        <AssociationConnector Association="DBMessageChatModel.FK_MessagesRecipients_UsersConversations" >
          <ConnectorPoint PointX="7.375" PointY="2.3362939453125" />
          <ConnectorPoint PointX="6.75" PointY="2.3362939453125" />
        </AssociationConnector>
      </Diagram>
    </Diagrams>
  </Designer>
</edmx:Edmx>